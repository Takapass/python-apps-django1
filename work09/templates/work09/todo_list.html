<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>TODO一覧</title>
    <style>
        .completed {
            text-decoration: line-through;
            color: gray;
        }

        .overdue {
            color: red;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <h1>TODOリスト</h1>

    <form method="POST" action="{% url 'todo_create' %}">
        {% csrf_token %}
        <input type="text" name="title" placeholder="タスク名" required>
        <input type="date" name="due_date" required>
        <button type="submit">追加</button>
    </form>

    <table border="1" cellpadding="8">
        <tr>
            <th>状態</th>
            <th>タスク</th>
            <th>期限</th>
            <th>登録日</th>
        </tr>
        {% for todo in todos %}
        <tr>
            <td>{% if todo.is_completed %}完了{% else %}未完了{% endif %}</td>
            <td class="{% if todo.is_completed %}completed{% endif %}">
                <a href="{% url 'todo_edit' todo.id %}">{{ todo.title }}</a>
            </td>
            <td class="{% if todo.due_date < today and not todo.is_completed %}overdue{% endif %}">
                {{ todo.due_date }}
            </td>
            <td>{{ todo.created_at|date:"Y-m-d" }}</td>
        </tr>
        {% endfor %}
    </table>
</body>

</html>